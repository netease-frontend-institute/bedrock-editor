(self.webpackChunk_ehr_ui_bedrock_editor=self.webpackChunk_ehr_ui_bedrock_editor||[]).push([[433],{62570:function(U,v,n){"use strict";n.r(v);var N=n(71543),m=n(59496),P=n(4637);v.default=function(){return(0,P.jsx)(N.ML,{})}},18843:function(U,v,n){"use strict";n.r(v);var N=n(71543),m=n(59496),P=n(4637),p='<p><span style="font-size:16px"><strong>\u5DE5\u5177\u5F00\u53D1\uFF1A</strong></span></p><p>V0.0.2\u7248\u672C\u4EA4\u4E92\u7A3F\u786E\u8BA4\uFF0C\u672C\u5468\u542F\u52A8\u4EA4\u4E92\u8BC4\u5BA1</p><p></p><p><span style="font-size:16px"><strong>\u914D\u97F3\u5DE5\u5177\u4E1A\u52A1\u589E\u957F\uFF1A</strong></span></p><p style="text-indent:2em;">\u5916\u90E8\u6E38\u620F\u5BA2\u6237\u5DF2\u62A5\u4EF7\uFF0C\u5DE5\u5177</p><p style="text-indent:2em;">\u4E60\u8FD1\u5E73\u603B\u4E66\u8BB0\u80AF\u5B9A\u4E86\u201C\u4E00\u5E26\u4E00\u8DEF</p><p style="text-indent:2em;">\u5B9E\u73B0\u4E86\u540C\u5171\u5EFA\u56FD\u5BB6\u4E92\u5229\u5171\u8D62</p><p style="text-indent:2em;"><span style="font-size:14px">\u5171\u5EFA\u2018\u4E00\u5E26\u4E00\u8DEF\u2019\uFF0C\u63D0\u9AD8\u4E86\u56FD\u5185\u5404\u533A\u57DF\u5F00\u653E\u6C34\u5E73\uFF0C\u62D3\u5C55\u4E86\u5BF9\u5916\u5F00\u653E\u9886\u57DF\uFF0C\u63A8\u52A8\u4E86\u5236\u5EA6\u578B\u5F00</span><br/></p>';v.default=function(){return(0,P.jsx)(N.ML,{initialHtml:p})}},16911:function(U,v,n){"use strict";n.r(v);var N=n(54306),m=n.n(N),P=n(59496),p=n(71543),M=n(99350),b=n(4637);v.default=function(){var V=(0,P.useRef)(null),z=(0,P.useState)(),F=m()(z,2),Y=F[0],S=F[1],y=(0,P.useState)(""),re=m()(y,2),G=re[0],ne=re[1],J=function(Q){var w;S(Q),ne((w=V.current)===null||w===void 0?void 0:w.convertToHTML(Q))};return(0,b.jsx)(M.Z,{type:"card",items:[{key:"1",label:"\u7F16\u8F91\u6A21\u5F0F",children:(0,b.jsx)(p.ML,{ref:V,onChange:J,editorState:Y})},{key:"2",label:"\u5C55\u793A\u6A21\u5F0F",children:(0,b.jsx)(p.M9,{content:G})}]})}},26436:function(U,v,n){"use strict";n.r(v);var N=n(71543),m=n(59496),P=n(4637);v.default=function(){return(0,P.jsx)(N.ML,{config:{getPlugins:function(M){return console.log("plugins",M),M.splice(5,1),M.push((0,N.Hn)()),M}}})}},21425:function(U,v,n){"use strict";n.r(v);var N=n(59496),m=n(71543),P=n(4637),p=function(b){return`<div style="width: 750px; margin: 0 auto;">
<div style="min-height: 128px; background-image: url(https://nos.netease.com/rms/7cf241cf1fb0b61f07d29dca9dce75cf); background-repeat: no-repeat; background-size: cover;">
<div style="padding: 70px 55px 0; overflow: hidden; font-size: 24px; color: #FFF; text-overflow: ellipsis; word-wrap: normal; white-space: nowrap; ">
<strong>\u90AE\u4EF6\u6807\u9898</strong>
</div></div><div style="padding: 20px 55px; background-color: #A00405;"><div style="padding: 30px; background-color: #FFF; border-radius: 10px;">`.concat(b,'</div></div><div style="height: 95px; background-image: url(https://nos.netease.com/rms/b2a0bcacab15a20508de56e0d69eedc4); background-repeat: no-repeat; background-size: cover;"></div></div>')};v.default=function(){return(0,P.jsx)(m.ML,{previewProps:{customPreview:p}})}},89398:function(U,v,n){"use strict";n.r(v);var N=n(59496),m=n(48161),P=n(71543),p=n(4637);v.default=function(){var M=(0,N.useRef)(null),b=function(){var z=M.current.editorRef,F=M.current.convertToHTML(z.getEditorState());console.log("htmlStr",F)};return(0,p.jsxs)("div",{children:[(0,p.jsx)(P.ML,{ref:M}),(0,p.jsx)(m.ZP,{onClick:b,children:"\u63D0\u4EA4"})]})}},98266:function(U,v,n){"use strict";n.r(v);var N=n(71543),m=n(59496),P=n(4637),p=[{id:1,fieldName:"\u5E94\u8058\u804C\u4F4D"},{id:2,fieldName:"\u5E94\u8058\u90E8\u95E8"},{id:3,fieldName:"\u5E94\u8058\u804C\u4F4D"},{id:4,fieldName:"\u5E94\u8058\u90E8\u95E8"},{id:5,fieldName:"\u5E94\u8058\u804C\u4F4D"},{id:6,fieldName:"\u5E94\u8058\u90E8\u95E8"},{id:7,fieldName:"\u5E94\u8058\u804C\u4F4D"},{id:8,fieldName:"\u5E94\u8058\u90E8\u95E8"}];v.default=function(){return(0,P.jsx)(N.ML,{tagList:p})}},71543:function(U,v,n){"use strict";n.d(v,{ML:function(){return ut},M9:function(){return ft},Hn:function(){return y.Hn}});var N=n(57213),m=n.n(N),P=n(25359),p=n.n(P),M=n(49811),b=n.n(M),V=n(54306),z=n.n(V),F=n(12342),Y=n.n(F),S=n(59496),y=n(1612),re=n(5711),G=n(81284),ne=n(47899),J=n.n(ne),ie=n(69542),Q=n(63466),w=n.n(Q),Ee=n(21140),se=n.n(Ee),he=n(68608),L=n.n(he),Pe=n(58853),ae=n.n(Pe),Ce=n(38888),ue=n.n(Ce),Ne=n(52510),K=n.n(Ne),Se=n(22234),jt=n(41834),x=n(4637),xe=S.forwardRef(function(c){var s=c.content,r=c.onCancel,t=c.wrapRef;return(0,x.jsx)(Se.Z,{title:"\u9884\u89C8",visible:!0,scrolled:!0,footer:null,onCancel:r,className:"popo-public-editor-preview-modal",destroyOnClose:!0,width:1e3,getContainer:function(){return t==null?void 0:t.getEditorDom()},children:(0,x.jsx)("div",{dangerouslySetInnerHTML:{__html:s},className:"rock-editor__renderer"})})}),Re=xe,Me=function(c){ae()(r,c);var s=ue()(r);function r(t,l){var e,o,a,u,i;return se()(this,r),i=s.call(this),K()(L()(i),"name","Preview"),K()(L()(i),"_popUp",null),K()(L()(i),"customPreview",void 0),K()(L()(i),"ref",void 0),K()(L()(i),"isEnabled",function(){return!0}),K()(L()(i),"waitForUserInput",function(d){return i._popUp?Promise.resolve(void 0):new Promise(function(g){var h;i._popUp=(0,y.wo)(Re,{wrapRef:(h=i.ref)===null||h===void 0?void 0:h.current,content:i.customPreview?i.customPreview((0,y.cn)(d)):(0,y.cn)(d),onOk:function(f){g(f),i._popUp.destroy(),i._popUp=null},onCancel:function(){g(void 0),i._popUp.destroy(),i._popUp=null}})})}),K()(L()(i),"executeWithUserInput",function(d,g,h,I){return!0}),i.icon=t,i.tooltip=(e=l.tooltip)!==null&&e!==void 0?e:{},i.desc=(o=l.desc)!==null&&o!==void 0?o:{},i.customPreview=(a=l.customPreview)!==null&&a!==void 0?a:null,i.ref=(u=l.ref)!==null&&u!==void 0?u:null,i}return w()(r)}(y.YY),Ie=Me,Te=function(s){var r=new Ie((0,x.jsx)(ie.Z,{}),{tooltip:{"zh-CN":"\u9884\u89C8","en-US":"Preview"},customPreview:s==null?void 0:s.customPreview,ref:s==null?void 0:s.ref});return r},be=Te;function Oe(c){var s=c||{},r=s.customPreview,t=s.ref;return new y.$n({key:new y.H$("preview"),getToolbarConfig:function(e){return e[e.length-1].push(be({customPreview:r,ref:t})),e}})}var je=Oe,Ue=n(78017),Le=n.n(Ue),Ke=n(44908),ke=n.n(Ke),De=function(s){var r=s.node,t=r.attrs,l=t.name;return(0,x.jsx)("span",{className:"keyword-item",children:l})};function Ae(){return function(c){ae()(r,c);var s=ue()(r);function r(t,l,e,o){return se()(this,r),s.call(this,t,l,e,o)}return w()(r,[{key:"createDOMElement",value:function(){var l=document.createElement("span");return l}},{key:"update",value:function(l,e){var o=Le()(ke()(r.prototype),"update",this).call(this,l,e);return o&&!0}},{key:"renderReactComponent",value:function(){return(0,x.jsx)(De,m()({},this.props))}}]),r}(y.rr)}var ze=Ae,Fe={attrs:{name:{default:""}},inline:!0,group:"inline",draggable:!0,toDOM:function(s){var r=s.attrs.name;return["span",{class:"keyword-item"},"".concat(r)]},parseDOM:[{tag:"span.keyword-item",getAttrs:function(s){var r=s.textContent;return{name:r}}}]};function we(){return new y.$n({key:new y.H$("tag"),nodeSpecs:{tag:Fe},nodeViews:{tag:ze()}})}var Be=we,We=n(58021),He=n(63269);function le(c,s){for(var r=c.nextSibling;r;){if(r.classList.contains(s))return r;r=r.nextSibling}return null}var $e=function(s){var r=s.tagList,t=s.onClick,l=s.isReady,e=(0,S.useRef)(null),o=function(){var u,i=le(e.current,"rock-editor");if(i){var d=i.querySelector(".rock-editor__toolbar");if(d){var g=(u=e.current)===null||u===void 0?void 0:u.offsetHeight;if(g){var h=le(d,"prosemirror-wrapper");h&&(h.style.marginTop="".concat(g,"px"))}}}};return(0,S.useEffect)(function(){return l&&o(),window.addEventListener("resize",o),function(){window.removeEventListener("resize",o)}},[l]),(0,x.jsx)("div",{className:"rock-editor-tag-extra-container",ref:e,children:(0,x.jsxs)(We.Z,{wrap:!0,children:["\u53EF\u9009\u5B57\u6BB5:",r==null?void 0:r.map(function(a){var u=a.id,i=a.fieldName;return(0,x.jsx)(He.Z,{text:i,size:"small",onClick:function(){return t(a)}},u)})]})})},Ze=$e,Ut=n(73989),Lt=n(34668),Ve=n(79935),R=n.n(Ve),Ge="https://netease-frontend-institute.github.io",Xe="https://ehr-service.netease.com",de=location.origin===Ge?Xe:location.origin,Ye=function(s){var r=s.nosKey,t=s.bucketName,l=s.fileName,e=s.nosUrl;return new Promise(function(o,a){R().ajax({type:"get",url:"".concat(de).concat(e),data:{nosKey:r,bucketName:t,fileName:encodeURIComponent(l),fileNameEncode:"URL_ENCODE"},success:function(i){return i.code===200?o(i.data):a()},error:a})})},Je=function(s){var r=s.uploader,t=s.param,l=s.nosKey,e=s.bucketName,o=s.nosUrl;return new Promise(function(a,u){r.upload(t,function(i){Ye({nosKey:l,bucketName:e,fileName:i.fileName,nosUrl:o}).then(function(d){a(d)}).catch(function(d){u(d)})})})},Qe=function(s){var r=s.uploader,t=s.file,l=s.nosKey,e=s.bucketName,o=s.token,a=s.trunkSize,u=s.nosUrl;return new Promise(function(i){r.addFile(t,b()(p()().mark(function d(){var g,h;return p()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return g={bucketName:e,objectName:l,token:o,trunkSize:a},f.next=3,Je({uploader:r,param:g,nosKey:l,bucketName:e,nosUrl:u});case 3:h=f.sent,i(h);case 5:case"end":return f.stop()}},d)})))})},_e=function(){var c=b()(p()().mark(function s(r){var t,l,e;return p()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(t=r.email,t){a.next=3;break}return a.abrupt("return",Promise.reject("no email"));case 3:return a.next=5,fetch("https://bedrock.netease.com:8010/api/bedrock/getPopoName?email=".concat(t));case 5:return l=a.sent,a.next=8,l.json();case 8:return e=a.sent,a.abrupt("return",e);case 10:case"end":return a.stop()}},s)}));return function(r){return c.apply(this,arguments)}}(),qe=function(s){return"https://unpkg.oa.netease.com/@bedrock/static/emoji-big/".concat(s)};function et(c){if(!c)return c;var s=document.createElement("div");s.innerHTML=c;for(var r=document.createTreeWalker(s,NodeFilter.SHOW_ELEMENT),t=r.nextNode();t;){var l=t.getAttribute("style");if(l&&!t.hasAttribute("data-indent")){var e=/text-indent:\s*(\d+)em;/i.exec(l);if(e){var o=parseInt(e[1],10)/2;t.setAttribute("data-indent","".concat(o,"em"))}}t=r.nextNode()}return s.innerHTML}var Kt=n(56154);function tt(c){"use strict";var s={protocol:location.protocol||"https:",urlDns:"http://wanproxy.127.net/lbs",retryCount:2,fileInputID:"fileInput",timeout:5e4,onError:function(e){console.log(e)},onProgress:function(e){console.log(e.status),console.log(e.progress)}},r,t;return r=R().extend({},s,c),t={version:"1.0",uploadFile:null,edgeNodeList:null,dnsRetryCount:0,uTRetryCount:r.retryCount,gORetryCount:r.retryCount,gDRetryCount:r.retryCount,createAjax:function(){var e={};return window.XMLHttpRequest&&(e=new XMLHttpRequest),e},clearStorage:function(e,o,a){localStorage.removeItem(a+"_progress"),localStorage.removeItem(a+"_"+e+"_"+o+"_context")},addFile:function(e,o){if(e){var a=J()(e.name+":"+e.size).toString(),u;u={fileKey:a,file:e,fileName:e.name,status:0,progress:localStorage.getItem(a+"_progress")||0},t.uploadFile&&(t.uploadFile=null),t.uploadFile=R().extend(!0,{},u),o&&o(u)}},getFile:function(e){var o;return t.uploadFile.fileKey===e&&(o=t.uploadFile),o},getDNS:function(e,o){if((e==null||e==="")&&(e=""),t.edgeNodeList)o(t.edgeNodeList);else if(r.protocol==="https:"){var a=["https://wanproxy-web.127.net"];t.edgeNodeList=a,o(a,r.urlDns)}else R().ajax({type:"get",url:r.urlDns,data:{version:t.version,bucketname:e},dataType:"json",success:function(i){i.code?r.onError({errCode:i.Code,errMsg:i.Message}):(t.edgeNodeList=i.upload,o(i.upload,i.lbs))},error:function(i){i.status.toString().match(/^5/)&&t.gDRetryCount>0&&t.gDRetryCount<r.retryCount+1?(t.getDNS(e,o),t.gDRetryCount--):(r.onError(i.responseText),t.gDRetryCount=r.retryCount)}})},getOffset:function(e,o){var a;if(a=localStorage.getItem(e.fileKey+"_"+e.bucketName+"_"+e.objectName+"_context"),!a)return o(0);R().ajax({type:"get",url:e.serveIp+"/"+e.bucketName+"/"+encodeURIComponent(e.objectName)+"?uploadContext",data:{version:t.version,context:a},dataType:"json",beforeSend:function(i){i.setRequestHeader("x-nos-token",e.token)},success:function(i){i.errCode?r.onError({errCode:i.errCode,errMsg:i.errMsg}):o(i.offset)},error:function(i){i.status.toString().match(/^5/)&&t.gORetryCount>0&&t.gORetryCount<r.retryCount+1?(t.getOffset(e,o),t.gORetryCount--):(r.onError(i.responseText),t.gORetryCount=r.retryCount,i.status===404&&t.clearStorage(e.bucketName,e.objectName,e.fileKey))}})},uploadTrunk:function(e,o,a){var u,i="",d,g,h=File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice;if(d=t.getFile(o.fileKey),g=localStorage.getItem(o.fileKey+"_"+e.bucketName+"_"+e.objectName+"_context"),d.xhr?u=d.xhr:(u=t.createAjax(),d.xhr=u),u.upload.onprogress=function(f){var E=0;f.lengthComputable?(E=(o.offset+f.loaded)/o.file.size,d.progress=(E*100).toFixed(2),E>0&&E<1?(d.status=1,R()("#"+r.fileInputID).attr("disabled",!0)):E===1&&(d.status=2,R()("#"+r.fileInputID).attr("disabled",!1)),localStorage.setItem(o.fileKey+"_progress",d.progress),r.onProgress(d)):(console.log("\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u8FDB\u5EA6\u4E8B\u4EF6",f),r.onError({errMsg:"\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u8FDB\u5EA6\u4E8B\u4EF6"}))},u.onreadystatechange=function(){if(u.readyState===4){var f;try{f=JSON.parse(u.responseText)}catch(O){f={errMsg:"\u672A\u77E5\u9519\u8BEF"}}if(u.status===200)d.file.size===0&&(d.status=2,d.progress=100,r.onProgress(d)),localStorage.setItem(o.fileKey+"_"+e.bucketName+"_"+e.objectName+"_context",f.context),f.offset<o.file.size?t.uploadTrunk(e,R().extend({},o,{offset:f.offset,trunkEnd:f.offset+o.trunkSize,context:g||f.context}),a):a(o);else if(u.status.toString().match(/^5/))if(t.uTRetryCount<r.retryCount+1&&t.uTRetryCount>0)t.getOffset({serveIp:e.serveIp,bucketName:e.bucketName,objectName:e.objectName,token:e.token,fileKey:o.fileKey},function(O){t.uploadTrunk(e,R().extend({},o,{offset:O,trunkEnd:O+o.trunkSize,context:localStorage.getItem(o.fileKey+"_"+e.bucketName+"_"+e.objectName+"_context")||""}),a)}),t.uTRetryCount--;else if(t.dnsRetryCount<t.edgeNodeList.length-1){t.uTRetryCount=r.retryCount,t.dnsRetryCount++;var E=R().extend({},e,{serveIp:t.edgeNodeList[t.dnsRetryCount]});t.getOffset({serveIp:E.serveIp,bucketName:E.bucketName,objectName:E.objectName,token:E.token,fileKey:o.fileKey},function(O){t.uploadTrunk(E,R().extend({},o,{offset:O,trunkEnd:O+o.trunkSize,context:localStorage.getItem(o.fileKey+"_"+e.bucketName+"_"+e.objectName+"_context")||""}),a)})}else t.dnsRetryCount=0,r.onError({errCode:f.errCode,errMsg:f.errMsg}),R()("#"+r.fileInputID).attr("disabled",!1),t.clearStorage(e.bucketName,e.objectName,o.fileKey);else R()("#"+r.fileInputID).attr("disabled",!1),u.status&&(t.clearStorage(e.bucketName,e.objectName,o.fileKey),r.onError({errCode:f.errCode,errMsg:f.errMsg}))}},i="?offset="+o.offset+"&complete="+(o.trunkEnd>=o.file.size)+"&context="+(g||o.context)+"&version="+t.version,u.open("post",e.serveIp+"/"+e.bucketName+"/"+encodeURIComponent(e.objectName)+i),u.timeout=r.timeout,u.setRequestHeader("x-nos-token",e.token),navigator.userAgent.indexOf("WindowsWechat")>=0){var I=new FileReader;I.addEventListener("loadend",function(){var f=new Blob([I.result]);u.send(f)}),I.readAsArrayBuffer(h.call(o.file,o.offset,o.trunkEnd))}else u.send(h.call(o.file,o.offset,o.trunkEnd))},pauseUpload:function(){var e;t.uploadFile?t.uploadFile.xhr?t.uploadFile.status<2&&(e=t.uploadFile.xhr,e.abort(),R()("#"+r.fileInputID).attr("disabled",!1)):r.onError({errMsg:"\u5F53\u524D\u6587\u4EF6\u672A\u5F00\u59CB\u4E0A\u4F20"}):r.onError({errMsg:"\u672A\u9009\u62E9\u9700\u4E0A\u4F20\u7684\u6587\u4EF6"})},upload:function(e,o){if(!e.bucketName&&e.bucketName!==0){r.onError({errMsg:"\u6876\u540D\u4E0D\u80FD\u4E3A\u7A7A"});return}if(!e.objectName&&e.objectName!==0){r.onError({errMsg:"\u5BF9\u8C61\u540D\u4E0D\u80FD\u4E3A\u7A7A"});return}if(!e.token){r.onError({errMsg:"\u4E0A\u4F20\u51ED\u8BC1\u4E0D\u80FD\u4E3A\u7A7A"});return}if(e.trunkSize?Object.prototype.toString.call(e.trunkSize)==="[object String]"&&(e.trunkSize=parseInt(e.trunkSize)):e.trunkSize=128*1024,!t.uploadFile){r.onError({errMsg:"\u672A\u9009\u62E9\u9700\u4E0A\u4F20\u7684\u6587\u4EF6"});return}var a=t.uploadFile;t.getDNS(e.bucketName,function(u){if(u.length===0){r.onError({errMsg:"\u6682\u65E0\u8FB9\u7F18\u8282\u70B9"});return}t.getOffset({serveIp:u[0],bucketName:e.bucketName,objectName:e.objectName,fileKey:a.fileKey,token:e.token},function(i){t.uploadTrunk({serveIp:u[0],bucketName:e.bucketName,objectName:e.objectName,token:e.token},{file:a.file,fileKey:a.fileKey,offset:i||0,trunkSize:e.trunkSize,trunkEnd:(i||0)+e.trunkSize,context:""},function(d){t.clearStorage(e.bucketName,e.objectName,d.fileKey),o&&o(a)})})})}},t}var rt=tt,nt=["config","initialHtml","tagList","onChange","uploadProps","previewProps","onReady"],ot=["features","getPlugins"],it=500*1024*1024,st=4*1024*1024;function at(c,s){var r=c.config,t=c.initialHtml,l=c.tagList,e=c.onChange,o=c.uploadProps,a=c.previewProps,u=c.onReady,i=Y()(c,nt),d=o||{},g=d.maxSize,h=g===void 0?it:g,I=d.beforeUpload,f=d.nosTokenUrl,E=f===void 0?"/api/file/nos/token":f,O=d.bucketName,ce=O===void 0?"rms":O,fe=d.trunkSize,vt=fe===void 0?st:fe,ve=d.nosUrl,gt=ve===void 0?"/api/file/nos/url":ve,oe=r||{},mt=oe.features,ge=oe.getPlugins,pt=Y()(oe,ot),yt=a||{},Et=yt.customPreview,ht=(0,S.useState)(!1),me=z()(ht,2),Pt=me[0],Ct=me[1],Nt=(0,S.useState)(),pe=z()(Nt,2),St=pe[0],xt=pe[1],k=(0,S.useRef)(null);(0,S.useImperativeHandle)(s,function(){return{editorRef:k.current,convertToHTML:y.cn}});var Rt=function(){var B=b()(p()().mark(function C(j,D){var W,H,A,_,X,$,q,Z,ee,te,ye;return p()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(W=D.onProgress,j){T.next=3;break}return T.abrupt("return",Promise.reject("\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25"));case 3:return H=0,A=setInterval(function(){H+=1,W(H),H>=90&&clearInterval(A)},100),_=j.size,X=j.name,$=J()(X+":"+_+":"+new Date().getTime()).toString(),T.next=9,fetch("".concat(de).concat(E,"?nosKey=").concat($,"&bucketName=").concat(ce));case 9:return q=T.sent,T.next=12,q.json();case 12:return Z=T.sent,ee=Z.data,te=rt({onError:function(){G.ZP.error("\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25")}}),T.next=17,Qe({uploader:te,file:j,nosKey:$,bucketName:ce,token:ee,nosUrl:gt,trunkSize:vt});case 17:return ye=T.sent,T.abrupt("return",{src:ye});case 19:case"end":return T.stop()}},C)}));return function(j,D){return B.apply(this,arguments)}}(),Mt=function(C){return C.name.length>100?(G.ZP.error("\u6587\u4EF6\u540D\u8FC7\u957F\uFF08\u9700\u63A7\u5236\u5728100\u5B57\u7B26\u5185\uFF09"),!1):C.size>h?(G.ZP.error("\u6587\u4EF6\u8FC7\u5927"),!1):I?I(C):!0},It=m()(m()({features:m()({invertWhenPasteSimilarColor:{enable:!0,threshold:.1},fontSize:!0,image:{singleButton:!0,allowEdit:!0},fullScreen:!0},mt||{}),beforeImageUpload:Mt,uploadImage:Rt},pt),{},{getPlugins:function(){var C=[(0,y._C)({getPopoName:_e}),(0,y.YV)(),(0,y.SN)(),je({customPreview:Et,ref:k}),(0,y._8)(),(0,y.hF)({insertAfter:"IndentDropdown"}),(0,y.zF)({covertNameToSrc:qe,insertAfter:"TextBgPicker"})];return l&&C.push(Be()),ge?ge(C):C}}),Tt=function(C){var j,D,W,H=(j=k.current)===null||j===void 0?void 0:j.getEditorState(),A=k==null||(D=k.current)===null||D===void 0||(W=D.getEditorView)===null||W===void 0?void 0:W.call(D),_=A||{},X=_.dispatch;if(X){var $=H||{},q=$.schema,Z=$.tr,ee=q.nodes.tag,te=ee.create({name:C.fieldName},null,void 0);Z=Z.replaceSelectionWith(te),X(Z)}A==null||A.focus()},bt=function(C){Ct(!0),u==null||u(C)},Ot=function(C,j){xt(C),e==null||e(C,j)};return(0,x.jsx)(x.Fragment,{children:(0,x.jsxs)("div",{className:"bedrock-editor-wrapper",children:[!!l&&(0,x.jsx)(Ze,{tagList:l,onClick:Tt,isReady:Pt}),(0,x.jsx)(y.ZP,m()(m()({autoFocus:!0},i),{},{editorState:St,onChange:Ot,ref:k,style:m()({"--r-editor-content-font-size":"14px","--r-editor-content-min-height":"240px","--r-editor-content-color":"#333","--text-color-1":"#333","--primary-1":"#1890ff","--br60":"#1890ff"},(i==null?void 0:i.style)||{}),config:It,onReady:bt,initialHtml:et(t)}))]})})}var ut=(0,S.forwardRef)(at),lt=n(49290),dt=n.n(lt),ct=function(s,r){var t=s.className,l=s.style,e=s.content,o=s.beforeRenderContent,a=s.useZmage,u=a===void 0?!0:a,i=s.usePopoLink,d=i===void 0?!0:i,g=(0,S.useRef)(null);(0,S.useImperativeHandle)(r,function(){return{element:g.current}});var h=o?o(e):e,I=function(E){E.persist(),u&&E.target.localName==="img"&&dt().browsing({src:E.target.currentSrc,backdrop:"rgba(0, 0, 0, 0.5)"})};return(0,S.useEffect)(function(){if(g.current&&d){var f=g.current.querySelectorAll(".popo-link-node");f.forEach(function(E){var O=E.getAttribute("data-email");E.addEventListener("click",function(){window.open("http://popo.netease.com/static/html/open_popo.html?ssid=".concat(O,"&sstp=0"))})})}},[h,d]),(0,x.jsx)("div",{ref:g,className:"rock-editor__renderer ".concat(t),style:m()(m()({},l||{}),{},{"--text-color-1":"#333"}),onClick:I,dangerouslySetInnerHTML:{__html:h}})},ft=(0,S.forwardRef)(ct)},86010:function(){}}]);
