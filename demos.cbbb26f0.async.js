(self.webpackChunk_ehr_ui_bedrock_editor=self.webpackChunk_ehr_ui_bedrock_editor||[]).push([[433],{62570:function(U,v,r){"use strict";r.r(v);var N=r(71543),g=r(59496),P=r(4637);v.default=function(){return(0,P.jsx)(N.g,{})}},18843:function(U,v,r){"use strict";r.r(v);var N=r(71543),g=r(59496),P=r(4637),m='<p><span style="font-size:16px"><strong>\u914D\u97F3\u5DE5\u5177\u5F00\u53D1\uFF1A</strong></span></p><p>V0.0.2\u7248\u672C\u4EA4\u4E92\u7A3F\u786E\u8BA4\uFF0C\u672C\u5468\u542F\u52A8\u4EA4\u4E92\u8BC4\u5BA1</p><p></p><p><span style="font-size:16px"><strong>\u914D\u97F3\u5DE5\u5177\u4E1A\u52A1\u589E\u957F\uFF1A</strong></span></p><p style="text-indent:2em;">\u5916\u90E8\u6E38\u620F\u5BA2\u6237\u5DF2\u62A5\u4EF7\uFF0C\u5DE5\u5177\u5E74\u8D3910\u4E07/\u5E74\uFF0C\u6309\u53E520\u5143/\u53E5</p><p style="text-indent:2em;">D90\u6301\u7EED\u751F\u6210\u914D\u97F3\u4E2D</p><p style="text-indent:2em;">\u4E92\u5A31\u97F3\u9891\u90E8\u5E0C\u671B\u5728\u914D\u97F3\u3001\u81EA\u5B9A\u4E49\u6280\u80FD\u8BED\u97F3\u3001\u5B9E\u65F6VC\u65B9\u9762\u90FD\u80FD\u591F\u548C\u4F0F\u7FB2\u5408\u4F5C\uFF0C\u5E94\u7528\u4E8E\u4E92\u5A31\u6E38\u620F\u4E2D\uFF0C\u5DF2\u7ED9\u4F0F\u7FB2\u63D0\u4F9B\u5927\u91CF\u6E38\u620F\u6570\u636E\uFF0C\u76EE\u524D\u53D1\u4F17\u5305\u6E05\u6D17\u6807\u6CE8\u4E2D</p><p style="text-indent:2em;"><span style="font-size:14px">DJ01\u914D\u97F3\uFF1A\u975E\u5E38\u9700\u8981\u7684\u652F\u6301\u82F1\u6587\uFF0C\u6682\u65E0\u4EBA\u529B\u652F\u6301\u3002</span><br/></p>';v.default=function(){return(0,P.jsx)(N.g,{initialHtml:m})}},16911:function(U,v,r){"use strict";r.r(v);var N=r(54306),g=r.n(N),P=r(59496),m=r(71543),I=r(99350),h=r(4637);v.default=function(){var H=(0,P.useRef)(null),Z=(0,P.useState)(),z=g()(Z,2),Y=z[0],b=z[1],p=(0,P.useState)(""),re=g()(p,2),V=re[0],ne=re[1],J=function(Q){var F;b(Q),ne((F=H.current)===null||F===void 0?void 0:F.convertToHTML(Q))};return(0,h.jsx)(I.Z,{type:"card",items:[{key:"1",label:"\u7F16\u8F91\u6A21\u5F0F",children:(0,h.jsx)(m.g,{ref:H,onChange:J,editorState:Y})},{key:"2",label:"\u5C55\u793A\u6A21\u5F0F",children:(0,h.jsx)(m.M,{content:V})}]})}},26436:function(U,v,r){"use strict";r.r(v);var N=r(71543),g=r(1612),P=r(59496),m=r(4637);v.default=function(){return(0,m.jsx)(N.g,{config:{getPlugins:function(h){return console.log("plugins",h),h.splice(5,1),h.push((0,g.Hn)()),h}}})}},21425:function(U,v,r){"use strict";r.r(v);var N=r(59496),g=r(71543),P=r(4637),m=function(h){return`<div style="width: 750px; margin: 0 auto;">
<div style="min-height: 128px; background-image: url(https://nos.netease.com/rms/7cf241cf1fb0b61f07d29dca9dce75cf); background-repeat: no-repeat; background-size: cover;">
<div style="padding: 70px 55px 0; overflow: hidden; font-size: 24px; color: #FFF; text-overflow: ellipsis; word-wrap: normal; white-space: nowrap; ">
<strong>\u90AE\u4EF6\u6807\u9898</strong>
</div></div><div style="padding: 20px 55px; background-color: #A00405;"><div style="padding: 30px; background-color: #FFF; border-radius: 10px;">`.concat(h,'</div></div><div style="height: 95px; background-image: url(https://nos.netease.com/rms/b2a0bcacab15a20508de56e0d69eedc4); background-repeat: no-repeat; background-size: cover;"></div></div>')};v.default=function(){return(0,P.jsx)(g.g,{previewProps:{customPreview:m}})}},89398:function(U,v,r){"use strict";r.r(v);var N=r(59496),g=r(48161),P=r(71543),m=r(4637);v.default=function(){var I=(0,N.useRef)(null),h=function(){var Z=I.current.editorRef,z=I.current.convertToHTML(Z.getEditorState());console.log("htmlStr",z)};return(0,m.jsxs)("div",{children:[(0,m.jsx)(P.g,{ref:I}),(0,m.jsx)(g.ZP,{onClick:h,children:"\u63D0\u4EA4"})]})}},98266:function(U,v,r){"use strict";r.r(v);var N=r(71543),g=r(59496),P=r(4637),m=[{id:1,fieldName:"\u5E94\u8058\u804C\u4F4D"},{id:2,fieldName:"\u5E94\u8058\u90E8\u95E8"},{id:3,fieldName:"\u5E94\u8058\u804C\u4F4D"},{id:4,fieldName:"\u5E94\u8058\u90E8\u95E8"},{id:5,fieldName:"\u5E94\u8058\u804C\u4F4D"},{id:6,fieldName:"\u5E94\u8058\u90E8\u95E8"},{id:7,fieldName:"\u5E94\u8058\u804C\u4F4D"},{id:8,fieldName:"\u5E94\u8058\u90E8\u95E8"}];v.default=function(){return(0,P.jsx)(N.g,{tagList:m})}},71543:function(U,v,r){"use strict";r.d(v,{g:function(){return nt},M:function(){return ut}});var N=r(57213),g=r.n(N),P=r(25359),m=r.n(P),I=r(49811),h=r.n(I),H=r(54306),Z=r.n(H),z=r(12342),Y=r.n(z),b=r(59496),p=r(1612),re=r(5711),V=r(81284),ne=r(47899),J=r.n(ne),ie=r(69542),Q=r(63466),F=r.n(Q),me=r(21140),se=r.n(me),pe=r(68608),K=r.n(pe),ye=r(58853),ue=r.n(ye),Ee=r(38888),ae=r.n(Ee),Pe=r(52510),L=r.n(Pe),he=r(22234),Nt=r(41834),S=r(4637),Ce=b.forwardRef(function(d){var s=d.content,n=d.onCancel,t=d.wrapRef;return(0,S.jsx)(he.Z,{title:"\u9884\u89C8",visible:!0,scrolled:!0,footer:null,onCancel:n,className:"popo-public-editor-preview-modal",destroyOnClose:!0,width:1e3,getContainer:function(){return t==null?void 0:t.getEditorDom()},children:(0,S.jsx)("div",{dangerouslySetInnerHTML:{__html:s},className:"rock-editor__renderer"})})}),Ne=Ce,Se=function(d){ue()(n,d);var s=ae()(n);function n(t,l){var e,o,u,a,i;return se()(this,n),i=s.call(this),L()(K()(i),"name","Preview"),L()(K()(i),"_popUp",null),L()(K()(i),"customPreview",void 0),L()(K()(i),"ref",void 0),L()(K()(i),"isEnabled",function(){return!0}),L()(K()(i),"waitForUserInput",function(c){return i._popUp?Promise.resolve(void 0):new Promise(function(y){var E;i._popUp=(0,p.wo)(Ne,{wrapRef:(E=i.ref)===null||E===void 0?void 0:E.current,content:i.customPreview?i.customPreview((0,p.cn)(c)):(0,p.cn)(c),onOk:function(f){y(f),i._popUp.destroy(),i._popUp=null},onCancel:function(){y(void 0),i._popUp.destroy(),i._popUp=null}})})}),L()(K()(i),"executeWithUserInput",function(c,y,E,R){return!0}),i.icon=t,i.tooltip=(e=l.tooltip)!==null&&e!==void 0?e:{},i.desc=(o=l.desc)!==null&&o!==void 0?o:{},i.customPreview=(u=l.customPreview)!==null&&u!==void 0?u:null,i.ref=(a=l.ref)!==null&&a!==void 0?a:null,i}return F()(n)}(p.YY),xe=Se,Re=function(s){var n=new xe((0,S.jsx)(ie.Z,{}),{tooltip:{"zh-CN":"\u9884\u89C8","en-US":"Preview"},customPreview:s==null?void 0:s.customPreview,ref:s==null?void 0:s.ref});return n},Me=Re;function Te(d){var s=d||{},n=s.customPreview,t=s.ref;return new p.$n({key:new p.H$("preview"),getToolbarConfig:function(e){return e[e.length-1].push(Me({customPreview:n,ref:t})),e}})}var be=Te,Ie=r(78017),Oe=r.n(Ie),je=r(44908),Ue=r.n(je),Ke=function(s){var n=s.node,t=n.attrs,l=t.name;return(0,S.jsx)("span",{className:"keyword-item",children:l})};function Le(){return function(d){ue()(n,d);var s=ae()(n);function n(t,l,e,o){return se()(this,n),s.call(this,t,l,e,o)}return F()(n,[{key:"createDOMElement",value:function(){var l=document.createElement("span");return l}},{key:"update",value:function(l,e){var o=Oe()(Ue()(n.prototype),"update",this).call(this,l,e);return o&&!0}},{key:"renderReactComponent",value:function(){return(0,S.jsx)(Ke,g()({},this.props))}}]),n}(p.rr)}var De=Le,ke={attrs:{name:{default:""}},inline:!0,group:"inline",draggable:!0,toDOM:function(s){var n=s.attrs.name;return["span",{class:"keyword-item"},"".concat(n)]},parseDOM:[{tag:"span.keyword-item",getAttrs:function(s){var n=s.textContent;return{name:n}}}]};function Ae(){return new p.$n({key:new p.H$("tag"),nodeSpecs:{tag:ke},nodeViews:{tag:De()}})}var ze=Ae,Fe=r(58021),Be=r(63269);function le(d,s){for(var n=d.nextSibling;n;){if(n.classList.contains(s))return n;n=n.nextSibling}return null}var We=function(s){var n=s.tagList,t=s.onClick,l=s.isReady,e=(0,b.useRef)(null),o=function(){var a,i=le(e.current,"rock-editor");if(i){var c=i.querySelector(".rock-editor__toolbar");if(c){var y=(a=e.current)===null||a===void 0?void 0:a.offsetHeight;if(y){var E=le(c,"prosemirror-wrapper");E&&(E.style.marginTop="".concat(y,"px"))}}}};return(0,b.useEffect)(function(){return l&&o(),window.addEventListener("resize",o),function(){window.removeEventListener("resize",o)}},[l]),(0,S.jsx)("div",{className:"rock-editor-tag-extra-container",ref:e,children:(0,S.jsxs)(Fe.Z,{wrap:!0,children:["\u53EF\u9009\u5B57\u6BB5:",n==null?void 0:n.map(function(u){var a=u.id,i=u.fieldName;return(0,S.jsx)(Be.Z,{text:i,size:"small",onClick:function(){return t(u)}},a)})]})})},we=We,St=r(73989),xt=r(34668),$e=r(79935),x=r.n($e),He=function(s){var n=s.nosKey,t=s.bucketName,l=s.fileName,e=s.nosUrl;return new Promise(function(o,u){x().ajax({type:"get",url:e,data:{nosKey:n,bucketName:t,fileName:encodeURIComponent(l),fileNameEncode:"URL_ENCODE"},success:function(i){return i.code===200?o(i.data):u()},error:u})})},Ze=function(s){var n=s.uploader,t=s.param,l=s.nosKey,e=s.bucketName,o=s.nosUrl;return new Promise(function(u,a){n.upload(t,function(i){He({nosKey:l,bucketName:e,fileName:i.fileName,nosUrl:o}).then(function(c){u(c)}).catch(function(c){a(c)})})})},Ve=function(s){var n=s.uploader,t=s.file,l=s.nosKey,e=s.bucketName,o=s.token,u=s.trunkSize,a=s.nosUrl;return new Promise(function(i){n.addFile(t,h()(m()().mark(function c(){var y,E;return m()().wrap(function(f){for(;;)switch(f.prev=f.next){case 0:return y={bucketName:e,objectName:l,token:o,trunkSize:u},f.next=3,Ze({uploader:n,param:y,nosKey:l,bucketName:e,nosUrl:a});case 3:E=f.sent,i(E);case 5:case"end":return f.stop()}},c)})))})},Ge=function(){var d=h()(m()().mark(function s(n){var t,l,e;return m()().wrap(function(u){for(;;)switch(u.prev=u.next){case 0:if(t=n.email,t){u.next=3;break}return u.abrupt("return",Promise.reject("no email"));case 3:return u.next=5,fetch("https://bedrock.netease.com:8010/api/bedrock/getPopoName?email=".concat(t));case 5:return l=u.sent,u.next=8,l.json();case 8:return e=u.sent,u.abrupt("return",e);case 10:case"end":return u.stop()}},s)}));return function(n){return d.apply(this,arguments)}}(),Xe=function(s){return"https://unpkg.oa.netease.com/@bedrock/static/emoji-big/".concat(s)};function Ye(d){if(!d)return d;var s=document.createElement("div");s.innerHTML=d;for(var n=document.createTreeWalker(s,NodeFilter.SHOW_ELEMENT),t=n.nextNode();t;){var l=t.getAttribute("style");if(l&&!t.hasAttribute("data-indent")){var e=/text-indent:\s*(\d+)em;/i.exec(l);if(e){var o=parseInt(e[1],10)/2;t.setAttribute("data-indent","".concat(o,"em"))}}t=n.nextNode()}return s.innerHTML}var Rt=r(56154);function Je(d){"use strict";var s={protocol:location.protocol||"https:",urlDns:"http://wanproxy.127.net/lbs",retryCount:2,fileInputID:"fileInput",timeout:5e4,onError:function(e){console.log(e)},onProgress:function(e){console.log(e.status),console.log(e.progress)}},n,t;return n=x().extend({},s,d),t={version:"1.0",uploadFile:null,edgeNodeList:null,dnsRetryCount:0,uTRetryCount:n.retryCount,gORetryCount:n.retryCount,gDRetryCount:n.retryCount,createAjax:function(){var e={};return window.XMLHttpRequest&&(e=new XMLHttpRequest),e},clearStorage:function(e,o,u){localStorage.removeItem(u+"_progress"),localStorage.removeItem(u+"_"+e+"_"+o+"_context")},addFile:function(e,o){if(e){var u=J()(e.name+":"+e.size).toString(),a;a={fileKey:u,file:e,fileName:e.name,status:0,progress:localStorage.getItem(u+"_progress")||0},t.uploadFile&&(t.uploadFile=null),t.uploadFile=x().extend(!0,{},a),o&&o(a)}},getFile:function(e){var o;return t.uploadFile.fileKey===e&&(o=t.uploadFile),o},getDNS:function(e,o){if((e==null||e==="")&&(e=""),t.edgeNodeList)o(t.edgeNodeList);else if(n.protocol==="https:"){var u=["https://wanproxy-web.127.net"];t.edgeNodeList=u,o(u,n.urlDns)}else x().ajax({type:"get",url:n.urlDns,data:{version:t.version,bucketname:e},dataType:"json",success:function(i){i.code?n.onError({errCode:i.Code,errMsg:i.Message}):(t.edgeNodeList=i.upload,o(i.upload,i.lbs))},error:function(i){i.status.toString().match(/^5/)&&t.gDRetryCount>0&&t.gDRetryCount<n.retryCount+1?(t.getDNS(e,o),t.gDRetryCount--):(n.onError(i.responseText),t.gDRetryCount=n.retryCount)}})},getOffset:function(e,o){var u;if(u=localStorage.getItem(e.fileKey+"_"+e.bucketName+"_"+e.objectName+"_context"),!u)return o(0);x().ajax({type:"get",url:e.serveIp+"/"+e.bucketName+"/"+encodeURIComponent(e.objectName)+"?uploadContext",data:{version:t.version,context:u},dataType:"json",beforeSend:function(i){i.setRequestHeader("x-nos-token",e.token)},success:function(i){i.errCode?n.onError({errCode:i.errCode,errMsg:i.errMsg}):o(i.offset)},error:function(i){i.status.toString().match(/^5/)&&t.gORetryCount>0&&t.gORetryCount<n.retryCount+1?(t.getOffset(e,o),t.gORetryCount--):(n.onError(i.responseText),t.gORetryCount=n.retryCount,i.status===404&&t.clearStorage(e.bucketName,e.objectName,e.fileKey))}})},uploadTrunk:function(e,o,u){var a,i="",c,y,E=File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice;if(c=t.getFile(o.fileKey),y=localStorage.getItem(o.fileKey+"_"+e.bucketName+"_"+e.objectName+"_context"),c.xhr?a=c.xhr:(a=t.createAjax(),c.xhr=a),a.upload.onprogress=function(f){var C=0;f.lengthComputable?(C=(o.offset+f.loaded)/o.file.size,c.progress=(C*100).toFixed(2),C>0&&C<1?(c.status=1,x()("#"+n.fileInputID).attr("disabled",!0)):C===1&&(c.status=2,x()("#"+n.fileInputID).attr("disabled",!1)),localStorage.setItem(o.fileKey+"_progress",c.progress),n.onProgress(c)):(console.log("\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u8FDB\u5EA6\u4E8B\u4EF6",f),n.onError({errMsg:"\u6D4F\u89C8\u5668\u4E0D\u652F\u6301\u8FDB\u5EA6\u4E8B\u4EF6"}))},a.onreadystatechange=function(){if(a.readyState===4){var f;try{f=JSON.parse(a.responseText)}catch(O){f={errMsg:"\u672A\u77E5\u9519\u8BEF"}}if(a.status===200)c.file.size===0&&(c.status=2,c.progress=100,n.onProgress(c)),localStorage.setItem(o.fileKey+"_"+e.bucketName+"_"+e.objectName+"_context",f.context),f.offset<o.file.size?t.uploadTrunk(e,x().extend({},o,{offset:f.offset,trunkEnd:f.offset+o.trunkSize,context:y||f.context}),u):u(o);else if(a.status.toString().match(/^5/))if(t.uTRetryCount<n.retryCount+1&&t.uTRetryCount>0)t.getOffset({serveIp:e.serveIp,bucketName:e.bucketName,objectName:e.objectName,token:e.token,fileKey:o.fileKey},function(O){t.uploadTrunk(e,x().extend({},o,{offset:O,trunkEnd:O+o.trunkSize,context:localStorage.getItem(o.fileKey+"_"+e.bucketName+"_"+e.objectName+"_context")||""}),u)}),t.uTRetryCount--;else if(t.dnsRetryCount<t.edgeNodeList.length-1){t.uTRetryCount=n.retryCount,t.dnsRetryCount++;var C=x().extend({},e,{serveIp:t.edgeNodeList[t.dnsRetryCount]});t.getOffset({serveIp:C.serveIp,bucketName:C.bucketName,objectName:C.objectName,token:C.token,fileKey:o.fileKey},function(O){t.uploadTrunk(C,x().extend({},o,{offset:O,trunkEnd:O+o.trunkSize,context:localStorage.getItem(o.fileKey+"_"+e.bucketName+"_"+e.objectName+"_context")||""}),u)})}else t.dnsRetryCount=0,n.onError({errCode:f.errCode,errMsg:f.errMsg}),x()("#"+n.fileInputID).attr("disabled",!1),t.clearStorage(e.bucketName,e.objectName,o.fileKey);else x()("#"+n.fileInputID).attr("disabled",!1),a.status&&(t.clearStorage(e.bucketName,e.objectName,o.fileKey),n.onError({errCode:f.errCode,errMsg:f.errMsg}))}},i="?offset="+o.offset+"&complete="+(o.trunkEnd>=o.file.size)+"&context="+(y||o.context)+"&version="+t.version,a.open("post",e.serveIp+"/"+e.bucketName+"/"+encodeURIComponent(e.objectName)+i),a.timeout=n.timeout,a.setRequestHeader("x-nos-token",e.token),navigator.userAgent.indexOf("WindowsWechat")>=0){var R=new FileReader;R.addEventListener("loadend",function(){var f=new Blob([R.result]);a.send(f)}),R.readAsArrayBuffer(E.call(o.file,o.offset,o.trunkEnd))}else a.send(E.call(o.file,o.offset,o.trunkEnd))},pauseUpload:function(){var e;t.uploadFile?t.uploadFile.xhr?t.uploadFile.status<2&&(e=t.uploadFile.xhr,e.abort(),x()("#"+n.fileInputID).attr("disabled",!1)):n.onError({errMsg:"\u5F53\u524D\u6587\u4EF6\u672A\u5F00\u59CB\u4E0A\u4F20"}):n.onError({errMsg:"\u672A\u9009\u62E9\u9700\u4E0A\u4F20\u7684\u6587\u4EF6"})},upload:function(e,o){if(!e.bucketName&&e.bucketName!==0){n.onError({errMsg:"\u6876\u540D\u4E0D\u80FD\u4E3A\u7A7A"});return}if(!e.objectName&&e.objectName!==0){n.onError({errMsg:"\u5BF9\u8C61\u540D\u4E0D\u80FD\u4E3A\u7A7A"});return}if(!e.token){n.onError({errMsg:"\u4E0A\u4F20\u51ED\u8BC1\u4E0D\u80FD\u4E3A\u7A7A"});return}if(e.trunkSize?Object.prototype.toString.call(e.trunkSize)==="[object String]"&&(e.trunkSize=parseInt(e.trunkSize)):e.trunkSize=128*1024,!t.uploadFile){n.onError({errMsg:"\u672A\u9009\u62E9\u9700\u4E0A\u4F20\u7684\u6587\u4EF6"});return}var u=t.uploadFile;t.getDNS(e.bucketName,function(a){if(a.length===0){n.onError({errMsg:"\u6682\u65E0\u8FB9\u7F18\u8282\u70B9"});return}t.getOffset({serveIp:a[0],bucketName:e.bucketName,objectName:e.objectName,fileKey:u.fileKey,token:e.token},function(i){t.uploadTrunk({serveIp:a[0],bucketName:e.bucketName,objectName:e.objectName,token:e.token},{file:u.file,fileKey:u.fileKey,offset:i||0,trunkSize:e.trunkSize,trunkEnd:(i||0)+e.trunkSize,context:""},function(c){t.clearStorage(e.bucketName,e.objectName,c.fileKey),o&&o(u)})})})}},t}var Qe=Je,_e=["config","initialHtml","tagList","uploadProps","previewProps","onReady"],qe=["features","getPlugins"],et=500*1024*1024,tt=4*1024*1024;function rt(d,s){var n=d.config,t=d.initialHtml,l=d.tagList,e=d.uploadProps,o=d.previewProps,u=d.onReady,a=Y()(d,_e),i=e||{},c=i.maxSize,y=c===void 0?et:c,E=i.beforeUpload,R=i.nosTokenUrl,f=R===void 0?"/api/file/nos/token":R,C=i.bucketName,O=C===void 0?"rms":C,de=i.trunkSize,at=de===void 0?tt:de,ce=i.nosUrl,lt=ce===void 0?"/api/file/nos/url":ce;console.log("render editor");var oe=n||{},dt=oe.features,fe=oe.getPlugins,ct=Y()(oe,qe),ft=o||{},vt=ft.customPreview,gt=(0,b.useState)(!1),ve=Z()(gt,2),mt=ve[0],pt=ve[1],D=(0,b.useRef)(null);(0,b.useImperativeHandle)(s,function(){return{editorRef:D.current,convertToHTML:p.cn}});var yt=function(){var G=h()(m()().mark(function M(j,k){var B,W,A,_,X,w,q,$,ee,te,ge;return m()().wrap(function(T){for(;;)switch(T.prev=T.next){case 0:if(B=k.onProgress,j){T.next=3;break}return T.abrupt("return",Promise.reject("\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25"));case 3:return W=0,A=setInterval(function(){W+=1,B(W),W>=90&&clearInterval(A)},100),_=j.size,X=j.name,w=J()(X+":"+_+":"+new Date().getTime()).toString(),T.next=9,fetch("".concat(f,"?nosKey=").concat(w,"&bucketName=").concat(O));case 9:return q=T.sent,T.next=12,q.json();case 12:return $=T.sent,ee=$.data,te=Qe({onError:function(){V.ZP.error("\u6587\u4EF6\u4E0A\u4F20\u5931\u8D25")}}),T.next=17,Ve({uploader:te,file:j,nosKey:w,bucketName:O,token:ee,nosUrl:lt,trunkSize:at});case 17:return ge=T.sent,T.abrupt("return",{src:ge});case 19:case"end":return T.stop()}},M)}));return function(j,k){return G.apply(this,arguments)}}(),Et=function(M){return M.name.length>100?(V.ZP.error("\u6587\u4EF6\u540D\u8FC7\u957F\uFF08\u9700\u63A7\u5236\u5728100\u5B57\u7B26\u5185\uFF09"),!1):M.size>y?(V.ZP.error("\u6587\u4EF6\u8FC7\u5927"),!1):E?E(M):!0},Pt=g()(g()({features:g()({invertWhenPasteSimilarColor:{enable:!0,threshold:.1},fontSize:!0,image:{singleButton:!0,allowEdit:!0},fullScreen:!0},dt||{}),beforeImageUpload:Et,uploadImage:yt},ct),{},{getPlugins:function(){var M=[(0,p._C)({getPopoName:Ge}),(0,p.YV)(),(0,p.SN)(),be({customPreview:vt,ref:D}),(0,p._8)(),(0,p.hF)({insertAfter:"IndentDropdown"}),(0,p.zF)({covertNameToSrc:Xe,insertAfter:"TextBgPicker"})];return l&&M.push(ze()),fe?fe(M):M}}),ht=function(M){var j,k,B,W=(j=D.current)===null||j===void 0?void 0:j.getEditorState(),A=D==null||(k=D.current)===null||k===void 0||(B=k.getEditorView)===null||B===void 0?void 0:B.call(k),_=A||{},X=_.dispatch;if(X){var w=W||{},q=w.schema,$=w.tr,ee=q.nodes.tag,te=ee.create({name:M.fieldName},null,void 0);$=$.replaceSelectionWith(te),X($)}A==null||A.focus()},Ct=function(M){pt(!0),u==null||u(M)};return(0,S.jsx)(S.Fragment,{children:(0,S.jsxs)("div",{className:"bedrock-editor-wrapper",children:[!!l&&(0,S.jsx)(we,{tagList:l,onClick:ht,isReady:mt}),(0,S.jsx)(p.ZP,g()(g()({autoFocus:!0},a),{},{ref:D,style:g()({"--r-editor-content-font-size":"14px","--r-editor-content-min-height":"240px","--r-editor-content-color":"#333","--text-color-1":"#333","--primary-1":"#1890ff","--br60":"#1890ff"},(a==null?void 0:a.style)||{}),config:Pt,onReady:Ct,initialHtml:Ye(t)}))]})})}var nt=(0,b.forwardRef)(rt),ot=r(49290),it=r.n(ot),st=function(s){var n=s.className,t=s.style,l=s.content,e=s.beforeRenderContent,o=s.useZmage,u=o===void 0?!0:o,a=s.usePopoLink,i=a===void 0?!0:a,c=(0,b.useRef)(null),y=e?e(l):l,E=function(f){f.persist(),u&&f.target.localName==="img"&&it().browsing({src:f.target.currentSrc,backdrop:"rgba(0, 0, 0, 0.5)"})};return(0,b.useEffect)(function(){if(c.current&&i){var R=c.current.querySelectorAll(".popo-link-node");R.forEach(function(f){var C=f.getAttribute("data-email");f.addEventListener("click",function(){window.open("http://popo.netease.com/static/html/open_popo.html?ssid=".concat(C,"&sstp=0"))})})}},[y,i]),(0,S.jsx)("div",{ref:c,className:"rock-editor__renderer ".concat(n),style:g()(g()({},t||{}),{},{"--text-color-1":"#333"}),onClick:E,dangerouslySetInnerHTML:{__html:y}})},ut=st},86010:function(){}}]);
